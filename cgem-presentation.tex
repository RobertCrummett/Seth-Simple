% CGEM Presentations in Plain TeX
%
% Contact: R Nate Crummett, 2024
%
% Color codes written by Joseph Wright, 2014

\newif\ifpdfmode

\begingroup\expandafter\expandafter\expandafter\endgroup
\expandafter\ifx\csname pdfoutput\endcsname\relax
\else
	\ifnum\pdfoutput>0 %
		\expandafter\expandafter\expandafter\pdfmodetrue
	\fi
\fi

\edef\currentcolor{%
	\ifpdfmode
		0 g 0 G%
	\else
		gray 0%
	\fi
}

\begingroup\expandafter\expandafter\expandafter\endgroup
\expandafter\ifx\csname pdfcolorstack\endcsname\relax
	\ifpdfmode
		\def\pdfcolorstackpush{\pdfliteral{\currentcolor}}%
		\let\pdfcolorstackpop\pdfcolorstackpush
	\fi
\else
	\chardef\colorstack=0 %
	\def\pdfcolorstackpush{%
		\pdfcolorstack\colorstackcnt push{\currentcolor}%
	}%
	\def\pdfcolorstackpop{%
		\pdfcolorstack\colorstackcnt pop\relax%
	}%
\fi

\edef\color#1{%
	\begingroup\noexpand\expandafter\noexpand\expandafter\noexpand\expandafter\endgroup
	\noexpand\expandafter\noexpand\ifx\noexpand\csname color#1\noexpand\endcsname\relax
		\def\noexpand\currentcolor{#1}%
	\noexpand\else
		\noexpand\expandafter\let\noexpand\expandafter\noexpand\currentcolor
		\noexpand\csname color#1\noexpand\endcsname
	\noexpand\fi
	\ifpdfmode
		\noexpand\pdfcolorstackpush
	\else
		\special{color push \noexpand\currentcolor}%
	\fi
	\aftergroup\noexpand\resetcolor
}

\edef\resetcolor{%
	\ifpdfmode
		\noexpand\pdfcolorstackpop
	\else
		\special{color pop}
	\fi
}

\edef\colorred  {\ifpdfmode 1 0 0 rg 1 0 0 RG \else rgb 1 0 0 \fi}
\edef\colorgreen{\ifpdfmode 0 1 0 rg 0 1 0 RG \else rgb 0 1 0 \fi}
\edef\colorblue {\ifpdfmode 0 0 1 rg 0 0 1 RG \else rgb 0 0 1 \fi}
\edef\colorblack{\ifpdfmode 0 0 0 rg 0 0 0 RG \else rgb 0 0 0 \fi}
\edef\colorwhite{\ifpdfmode 1 1 1 rg 1 1 1 RG \else rgb 1 1 1 \fi}
